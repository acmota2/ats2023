<?xml version="1.0" encoding="UTF-8"?><!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Strict//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-strict.dtd"><html xmlns="http://www.w3.org/1999/xhtml" lang="en"><head><meta http-equiv="Content-Type" content="text/html;charset=UTF-8"/><link rel="stylesheet" href="../jacoco-resources/report.css" type="text/css"/><link rel="shortcut icon" href="../jacoco-resources/report.gif" type="image/gif"/><title>Controller.java</title><link rel="stylesheet" href="../jacoco-resources/prettify.css" type="text/css"/><script type="text/javascript" src="../jacoco-resources/prettify.js"></script></head><body onload="window['PR_TAB_WIDTH']=4;prettyPrint()"><div class="breadcrumb" id="breadcrumb"><span class="info"><a href="../jacoco-sessions.html" class="el_session">Sessions</a></span><a href="../index.html" class="el_report">ats</a> &gt; <a href="index.source.html" class="el_package">org.example.Main</a> &gt; <span class="el_source">Controller.java</span></div><h1>Controller.java</h1><pre class="source lang-java linenums">package org.example.Main;

import org.example.CasaInteligente.CasaInteligente;
import org.example.CasaInteligente.DivisaoJaExisteException;
import org.example.Fatura.Fatura;
import org.example.Fornecedor.Fornecedor;
import org.example.Fornecedor.FornecedorComNomeJaExistenteException;
import org.example.Fornecedor.FornecedorTipo1;
import org.example.Fornecedor.FornecedorTipo2;
import org.example.Sistema.*;
import org.example.SmartDevice.SmartBulb;
import org.example.SmartDevice.SmartCamera;
import org.example.SmartDevice.SmartDevice;
import org.example.SmartDevice.SmartSpeaker;

import java.io.FileNotFoundException;
import java.io.IOException;
import java.time.LocalDate;
import java.time.format.DateTimeFormatter;
import java.time.format.DateTimeParseException;
import java.util.List;
import java.util.Random;
import java.util.Scanner;
import java.util.TreeSet;

public class Controller {
    private Sistema sistema;

<span class="nc" id="L29">    public Controller() {</span>
<span class="nc" id="L30">        this.sistema=new Sistema();</span>
<span class="nc" id="L31">    }</span>

    public boolean Precondition2() {
<span class="nc bnc" id="L34" title="All 2 branches missed.">        return this.sistema.getNrFornecedores()&gt;0;</span>
    }

    public boolean Precondition4() {
<span class="nc bnc" id="L38" title="All 4 branches missed.">        return this.Precondition2() &amp;&amp; this.sistema.getNrCasasInteligentes()&gt;0;</span>
    }

    public boolean Precondition6() {
<span class="nc bnc" id="L42" title="All 4 branches missed.">        return this.Precondition2() &amp;&amp; this.sistema.TemFaturas() ;</span>
    }


    public void addRoom(int nif,String nome) throws DivisaoJaExisteException{
<span class="nc" id="L47">        this.sistema.adicionaDivisao(nif,nome);</span>

<span class="nc" id="L49">    }</span>
    public void InsereCasa(String nome,int nif,String nomeFornecedor) {
        try {
<span class="nc" id="L52">            CasaInteligente c= new CasaInteligente(nome,nif,nomeFornecedor);</span>
<span class="nc" id="L53">            this.sistema.adicionaCasa(c);</span>
<span class="nc" id="L54">        } catch (NumberFormatException e) {</span>
<span class="nc" id="L55">            System.out.println(&quot;Formato do NIF errado! Não foi possível adicionar a Casa Inteligente!&quot;);</span>
<span class="nc" id="L56">        } catch (CasaExceptionNifExistente | CasaExceptionFornecedorNaoExiste e) {</span>
<span class="nc" id="L57">            System.out.println(e.getMessage() + &quot; Não foi possível adicionar a Casa Inteligente!&quot;);</span>
<span class="nc" id="L58">        }</span>
<span class="nc" id="L59">    }</span>

    public void InsereFornecedor(String nome, double precobase,double  imposto,double multiplicador) {

            try {
<span class="nc" id="L64">                Random r= new Random();</span>
<span class="nc bnc" id="L65" title="All 2 branches missed.">                 Fornecedor f= r.nextBoolean()</span>
                                ? new FornecedorTipo1(
                                nome,
                                precobase,
                                imposto,
                                multiplicador
                        )
                                : new FornecedorTipo2(
                                nome,
                                precobase,
                                imposto,
                                multiplicador
                        );
<span class="nc" id="L78">                this.sistema.adicionaFornecedor(f);</span>
<span class="nc" id="L79">        } catch (NumberFormatException e) {</span>
<span class="nc" id="L80">            System.out.println(&quot;O último dado introduzido não está na forma correta. Não foi possível adicionar o dispositivo!&quot;);</span>
<span class="nc" id="L81">        } catch (FornecedorComNomeJaExistenteException e) {</span>
<span class="nc" id="L82">            System.out.println(e.getMessage() + &quot; Não foi possível adicionar a Empresa!&quot;);</span>
<span class="nc" id="L83">        }</span>
<span class="nc" id="L84">    }</span>

    public String getSistema () {
<span class="nc" id="L87">        return this.sistema.toString();</span>
    }

    public void setSistema(Sistema sistema) {
<span class="nc" id="L91">        this.sistema = sistema.clone();</span>
<span class="nc" id="L92">    }</span>

    public void guardaEstado(String nome) throws FileNotFoundException, IOException {
<span class="nc" id="L95">        sistema.guardaEstado(nome);</span>
<span class="nc" id="L96">    }</span>

    public void carregaEstado(String nome) throws FileNotFoundException, IOException, ClassNotFoundException {
        //sistema = new Sistema();
<span class="nc" id="L100">        this.sistema = this.sistema.carregaEstado(nome);</span>
<span class="nc" id="L101">    }</span>


    public String executaQuery1(LocalDate datainic,LocalDate dataFim) {
<span class="nc" id="L105">       return  this.sistema.casaQueMaisGastou(datainic,dataFim).toString();</span>
    }

    public String executaQuery2() {
<span class="nc" id="L109">        return this.sistema.fornecedorQueMaisFaturou();</span>
    }

    public String executaQuery3(String nome) throws CasaExceptionFornecedorNaoExiste {
<span class="nc" id="L113">        return this.sistema.faturasDoFornecedor(nome).toString();</span>
    }

    public String  executaQuery4(LocalDate datainic, LocalDate dataFim) {
<span class="nc" id="L117">       return  this.sistema.maioresConsumidoresEnergia(datainic,dataFim).toString();</span>
    }

    public void simulacao(LocalDate date) throws DateTimeParseException {
<span class="nc" id="L121">        sistema.simulacao(date);</span>
<span class="nc" id="L122">    }</span>

    public LocalDate getTime () {
<span class="nc" id="L125">        return this.sistema.getTime();</span>
    }

    public void addDevice(int nif, String nomeDivisao, SmartDevice smartDevice) throws DispositivoExisteNaDivisaoException {
<span class="nc" id="L129">        this.sistema.addDevice(nif,nomeDivisao,smartDevice);</span>
<span class="nc" id="L130">    }</span>

    public void setFornecedorEm(int nif, String fornecedor) throws CasaExceptionFornecedorNaoExiste, RuntimeException {
<span class="nc bnc" id="L133" title="All 2 branches missed.">        if(!this.sistema.getListaFornecedores().containsKey(fornecedor)) {</span>
<span class="nc" id="L134">            throw new CasaExceptionFornecedorNaoExiste(&quot;Não é um fornecedor válido&quot;);</span>
        }
<span class="nc bnc" id="L136" title="All 2 branches missed.">        if(!this.sistema.getListaCasas().containsKey(nif)) {</span>
<span class="nc" id="L137">            throw new RuntimeException(&quot;Não é um NIF válido&quot;);</span>
        }
<span class="nc" id="L139">        this.sistema.getListaCasas().get(nif).setNomeFornecedor(fornecedor);</span>
<span class="nc" id="L140">    }</span>
}
</pre><div class="footer"><span class="right">Created with <a href="http://www.jacoco.org/jacoco">JaCoCo</a> 0.8.8.202204050719</span></div></body></html>